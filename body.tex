% TODO: Add PIMS note for Guu.
% TODO: Add affiliation and email for all authors.

\section{Introduction}

Classical theory of algebras admits a categorification to tensor categories
and module categories. They proved to be very useful in several setups:
representation theory, quantum field theory (topological in $3$, $4$
dimensions, conformal in $2$ dimensions), and topological matters. A well
known construction that categorifies the tensor product of two algebras is the
Deligne tensor product for two linear categories.

The Deligne tensor product is later generalized by the balanced tensor product
(TODO: reference): given a tensor category $C$ and module categories
$M_{C} \,,\, {}_{C}N$, the balanced tensor product $M \boxtimes_{C} N$ is a
linear category that best approximates the Deligne tensor product in the
context of $C$-module categories. In the theory of topological phase, this
construction corresponds to fusing two domains (labeled by $M$ and $N$) over
the domain wall (labeled by $C$) (TODO: ref Kong). In the theory ($3$D, fully
extended) topological quantum field theory, this provides the natural
composition for the $1$-morphisms in a usual target $3$-category $TC$ (TODO:
ref). In the theory of vertex operator algebra (VOA), this construction help
study them by relating various VOAs, and constructing new VOAs. As a very
special case, the Drinfeld center $Z(C)$ for $C$ can be constructed as
$C \boxtimes_{C \boxtimes C^{op}} C$.

As in the context of classical algebra, such tensor product is first defined
via a universal property. What makes the situation slightly different is that
in the classical theory, a construction for the tensor product is quite
straightforward. In our context, there were known a few constructions too: for
example (1) category of bimodules (ref: Douglas2014), (2) center construction
(Etingof2010, KirillovTham2020, H's master).

However, these models hinder (right word?) the
``topological/skein-theoretical'' nature of tensor categories. This has two drawbacks: (1) the computation about the balanced tensor products becomes more difficult once there are multiple domains to be fused, e.g.
\[ {}_{A}{M}_{B} \boxtimes_{B} {}_{B}{N}_{C} \boxtimes_{{C}} {}_{C}{L}_{D} \ldots
\]
(2) it makes it difficult to see the relation between the fully extended $3$D
topological field theories (targeting $TC$) to the Turaev-Viro state sum.

This note provides a skein-theoretic model for $M \boxtimes_{C} N$, resolving
these drawbacks. In the following work, the authors will use this result to
show a well- and long- expected relation between the Turaev-Viro state sum and
the fully extended $3$D TFT targeting $TC$. We expect the same method will
also work for revealing the relation between their analogues in $4$D, i.e. the
Crane-Yetter state sum model.

\subsection*{A note to experts}\label{subsection/a-note-to-experts}

The idea of main theorem provided in this paper is well-expected, at least by
multiple (mathematical) physicists. However, to our best knowledge, it has not
been mathematically proven.

\section{Balanced Tensor Product}\label{section/balanced-tensor-product}

\begin{definition} (Balanced Module Category Functor)

  \noindent Let $C, D, E$ be tensor categories. Let $_{C}M_{D}$ be a $C-D$
  bimodule category, $_{D}N_{E}$ be a $D-E$ bimodule category, $_{C}L_{E}$ be a $C-E$ bimodule category.

  \noindent Then a $D$-balanced $C-E$ bimodule category functor (from $M \times N$ to $L$) is a pair
  \[(M \times N \xrightarrow{F} L, \alpha)\]
  where $F$ is a right-exact bilinear (?) $C-E$ bimodule category functor and $\alpha$ is a natural isomorphism between the following two functors
  \[
    \begin{tikzcd}
      M \times D \times N \arrow[r] \arrow[dr] &
      M \times N \arrow[d, Rightarrow, "\alpha"] \arrow[r, "F"] &
      L \\
      & M \times N \arrow[ur, "F"'] \\
    \end{tikzcd}
  \]
  where the object $(m,d,n)$ in $M \times D \times N$ is sent by the first
  upper arrow to $(m \lhd d, n)$, and by the first lower arrow to $(m, d \rhd n)$.
\end{definition}

\begin{remark}
  The triangle and pentagonal identities for $D$ is automatically satisfied
  (see Jin's note 20240906-110000 p.2).
\end{remark}

\begin{definition} (Balanced Natural Transformation)

  \noindent Let $C, D, E$ be tensor categories. Let $_{C}M_{D}$ be a $C-D$
  bimodule category, $_{D}N_{E}$ be a $D-E$ bimodule category, $_{C}L_{E}$ be
  a $C-E$ bimodule category. Let $F, F'$ be $D$-balanced $C-E$ bimodule
  category functors from $M \times N$ to $L$. A $D$-balanced transformation
  from $F$ to $F'$ is a natural transformation $ F \xrightarrow{\eta} F'$ such
  that the following diagram commutes (in a naturally compatible way with the
  $C-E$ bimodule structures.)

  % TODO FIXME the vertices are shown wrong.
  \[
    \begin{tikzcd}
      A \arrow[r, "\alpha_{m,c,n}"] \arrow[d, "\eta_{m \lhd c, n}"'] &
      B \arrow[d, "\eta_{m, c \rhd n}"] \\
      C \arrow[r, "\alpha_{m,c,n}'"'] & D
    \end{tikzcd}
  \]
\end{definition}

\begin{definition} (Category of Balanced Functors)

  \noindent Let $C, D, E$ be tensor categories. Let $_{C}M_{D}$ be a $C-D$
  bimodule category, $_{D}N_{E}$ be a $D-E$ bimodule category, $_{C}L_{E}$ be
  a $C-E$ bimodule category. Let $F, F'$ be $D$-balanced $C-E$ bimodule
  category functors from $M \times N$ to $L$.

  \noindent Then the category of balanced functors
  $Fun^{D-bal}_{C,E}(M \times N, L)$ is defined to be the category whose
  objects are $D$-balanced $C-E$ bimodule category functors $M \times N \to L$
  and whose morphisms are $D$-balanced natural transformations.
\end{definition}

\begin{definition} (Balanced Tensor Product)

  \noindent Let $C, D, E$ be tensor categories. Let $_{C}M_{D}$ be a $C-D$
  bimodule category, and $_{D}N_{E}$ be a $D-E$ bimodule category.

  \noindent Then the balanced tensor product $_{C}(M \boxtimes_{D} N)_{E}$ is
  the $C-E$ bimodule category defined as the initial $D$-balanced module
  functor from $M \times N$; i.e. for each map from $M \times N$ to some $C-E$
  bimodule category $L$, there exists a unique $C-E$ bimodule category functor
  $G$ such that the following diagram commutes,

  \[
    \begin{tikzcd}
      M \times N \arrow[r, "F"] \arrow[d, "\boxtimes_{D}"'] & L \\
      _{C}(M \boxtimes_{D} N)_{E} \arrow[ur, "G"']
    \end{tikzcd}
  \]

  \noindent and that it induces an equivalence of category
  \[Fun_{C,E}(M \boxtimes_{D} N, L) \simeq Fun_{C,E}^{D-bal}(M \times N, L).\]
\end{definition}

\begin{remark}
  This definition is a straight generatlization from axXiv:1406.4204. We want
  to understand $_{C}M \boxtimes_{D} N_{E}$ in terms of skein category. Note that that
  paper implements it using category of modules, while KirillovTham2020 and
  Hoek's master's thesis (and another paper by Etingof et al around 2010)
  implements it as a center (for the finite + ss case). 1202.0061 imeplements
  it as $Fun_{D,re}(M^{op},N)$ for finite case. Eventually it's ifeal for us
  to connect our construction back to these cases.
\end{remark}

\section{Skein Construction}\label{section/skein-construction}

\begin{definition} (Pre-Skein Category)

  \noindent Let $C$ be a tensor category, and $M_{C}, _{C}N$ be module
  categories. Define the pre-skein category $p.sk(M,C,N)$ to be the category
  $P$ with $Obj(P) = Obj(M \boxtimes N)$, and the morphism spaces
  $Mor_{P}((m \boxtimes n), (m' \boxtimes n'))$ are defined to be $V / \sim$,
  where
  \[
    V := \oplus_{c,\overline{c} \in Obj(C)} Hom_{M}(m, m' \rhd c) \otimes Hom_{C}(c,\overline{c}) \otimes Hom_{N} (\overline{c} \lhd n, n'),
  \]
  and $\sim$ are generated by the following types of relations
  \begin{align}
    \phi \otimes (\pi' \circ \pi) \otimes \psi - (\phi_{\pi'} \otimes \pi \otimes \psi)\\
    \phi \otimes (\pi' \circ \pi) \otimes \psi - (\phi \otimes \pi' \otimes _{\pi}\psi).
  \end{align}
  The composition
  \[
    \phi'' \otimes \pi'' \otimes \psi'' =
    (\phi' \otimes \pi' \otimes \psi' ) \circ (
    \phi \otimes \pi \otimes \psi ),
  \]
  is defined so that
  \[
    \pi'' = c' \otimes c \xrightarrow{\pi' \otimes \pi} \overline{c'} \otimes \overline{c},
  \]
  \noindent $\phi'' \in Hom_{M}(m, m'' \rhd (c' \otimes c))$ is
  \[
    m \xrightarrow{\phi} m' \rhd c \xrightarrow{\phi' \rhd 1_{c}} \xrightarrow[\sim]{\alpha} m'' \rhd (c' \otimes c).
  \]
  \noindent and $\psi'' \in Hom_{N}((\overline{c}' \otimes \overline{c}) \lhd n, n'')$ is
  \[
    (\overline{c}' \otimes \overline{c}) \lhd n \xrightarrow[\sim]{\alpha} \overline{c}' \lhd (\overline{c} \lhd n) \xrightarrow{1_{\overline{c}'} \lhd \psi} \overline{c}' \lhd n' \xrightarrow{\psi'} n''.
  \]
  % TODO Check that composition descends well to quotients.

\end{definition}

\begin{notation} (${}^{m'}_{n'}I^{m}_{n}$)

  \noindent Denote the equivalence class of the vector
  $(\phi \otimes \pi \otimes \psi) \in V$ by
  \[\III{m'}{n'}{m}{n}{\phi}{\psi}{c}{\pi}{c'}.\]
  When $m' = m$ and $n' = n$, we omit the primed symbols and write
  \[
    \III{}{}{m}{n}{\phi}{\psi}{c}{\pi}{c'} :=
    \III{m}{n}{m}{n}{\phi}{\psi}{c}{\pi}{c'}.
  \]
  When $\pi = 1_{c}$ (thus $c' = c$), we abbreviate it further to
  \[
    \II{m'}{n'}{m}{n}{\phi}{\psi}{c} :=
    \III{m'}{n'}{m}{n}{\phi}{\psi}{c}{1_{c}}{c},
  \]
  and
  \[
    \II{}{}{m}{n}{\phi}{\psi}{c} :=
    \III{m}{n}{m}{n}{\phi}{\psi}{c}{1_{c}}{c}.
  \]
\end{notation}

\begin{remark} (Skein Nature of the Notation ${}^{m'}_{n'}I^{m}_{n}$)

  \noindent Informally yet instructively, it is helpful to view
  $\III{m'}{n'}{m}{n}{\phi}{\psi}{c}{\pi}{c'}$ as a skein flowing from the
  right to the left, starting from $m \boxtimes n$ to $m' \boxtimes n'$,
  passing through $\phi \boxtimes \psi$; during the process, the upper strain
  emits a particle $c$, which transforms to via $\pi$ to $\overline{c}$, and
  hits the lower strain. Hence under the defined composition rule (see the
  equation for $\phi'' \otimes \pi'' \otimes \psi''$ above), we have
  \[
    \III{m''}{n''}{m'}{n'}{\phi'}{\psi'}{c'}{\pi'}{\overline{c}'} \circ
    \III{m'}{n'}{m}{n}{\phi}{\psi}{c}{\pi}{\overline{c}} =
    \III{m''}{n''}{m}{n}{\phi''}{\psi'}{c' \otimes c}{\pi''}{\overline{c}' \otimes \overline{c}}.
  \]
\end{remark}

\begin{remark}\label{remark/hom-space-reduction} (Hom Space Reduction)

  \noindent By the given relation, the
  transformation
  \[
    \pi = 1_{\overline{c}} \circ \pi = \pi \circ 1_{c}
  \]
  can be absorbed into each of the strain, so
  \[
    \II{m'}{n'}{m}{n}{\phi}{{}_{\pi}\psi}{c} =
    \III{m'}{n'}{m}{n}{\phi}{{}_{\pi}\psi}{c}{1_{c}}{c} =
    \III{m'}{n'}{m}{n}{\phi}{\psi}{c}{\pi}{c'} =
    \III{m'}{n'}{m}{n}{\phi_{\pi}}{\psi}{c'}{1_{c'}}{c'} =
    \II{m'}{n'}{m}{n}{\phi_{\pi}}{\psi}{c'}.
  \]

  \noindent Furthermore, if $c \simeq \oplus_{i=1}^{l} c_{i}$, then
  \[
    \II{m'}{n'}{m}{n}{\phi}{\psi}{c} = \II{m'}{n'}{m}{n}{\phi}{\psi}{\oplus_{i=1}^{l} c_{i}} = \sum_{j=1}^{l} \III{m'}{n'}{m}{n}{\phi_{j}}{\psi}{c_{j}}{\iota_{j}}{\oplus_{i=1}^{l} c_{i}} =
    \sum_{j=1}^{l}\II{m'}{n'}{m}{n}{\phi_{j}}{\psi_{j}}{c_{j}},
  \]
  where $\iota_{j}$ denotes the $j$-th embedding map from $c_{j}$ to
  $\oplus_{i=1}^{l}c_{i}$, and the $\phi_{j}, \psi_{j}$'s denote the $j$-th
  projection of $\phi, \psi$ respectively. In particular, when
  $c \simeq x^{\oplus l}$, the this gives a reduction from
  \[
    Hom_{M}(m, m' \rhd x^{\oplus l}) \otimes Hom_{C}(x^{\oplus l}, x^{\oplus l}) \otimes Hom_{N} (x^{\oplus l} \lhd n, n')
  \]
  to
  \[
    Hom_{M}(m, m' \rhd x) \otimes Hom_{C}(x, x) \otimes Hom_{N} (x \lhd n, n').
  \]
  It is instructive to regard the result as the ``inner product'' of $\phi$
  and $\psi$.
\end{remark}

\begin{proposition} (Basis Theorem) Let $C$ be a finite, semisimple tensor
  category, and $M_{C}, _{C}N$ be finite, semisimple module categories over
  $C$. Thus the vector spaces $Hom_{M}(m, m' \lhd c), Hom_{N}(c \rhd n, n')$ have
  finite bases $\beta(m, m' \lhd c), \beta(c \rhd n, n')$ respectively. Then the hom
  space $Hom_{p.sk(M,C,N)}(m \boxtimes n, m' \boxtimes n')$ has a linear basis
  \[
    \bigsqcup_{c \in Irr(C)} \beta(m, m' \lhd c) \times \beta(c \rhd n, n').
  \]
\end{proposition}
\begin{proof}
  This follows immediately from the reductions given in \ref{remark/hom-space-reduction}.
\end{proof}

\begin{definition} (Karoubi Completion)

  \noindent Let $C$ be a category. The Karoubi completion $Kar(C)$ of $C$ is defined to be the category with
  \[
    Obj(Kar(C)) = \{(c, f) \,|\, c \in Obj(C), f \in End_{C}(c), f = f^{2}\}
  \] and
  \[
    Mor_{Kar(C)}((c,f), (c', f')) = \{\overline{f} \in Hom_{C}(c,c') \,|\, \overline{f}f = \overline{f} = f'\overline{f}\},
  \]
  with the obvious composition rule.
\end{definition}

\begin{definition} (Skein Category)

  \noindent Let $C$ be a tensor category, and $M_{C}, _{C}N$ be module categories.
  Define the skein category $sk(M,C,N)$ to the Karoubi completion of its pre-skein category
  \[
    sk(M,C,N) := Kar(p.sk(M,C,N)).
  \]
  \noindent Thus, a typical object of the skein category $sk(M,C,N)$ is an
  idempotent skein $\II{m}{n}{m}{n}{\phi}{\psi}{c}$.
\end{definition}

\noindent The skein category $sk(M,C,N)$ is our model for $M \boxtimes_{C} N$;
we will prove this later. A necessary ingredient is the canonical map
$\boxtimes_{C}$ given in the defining universal property.

\begin{definition}\label{definition/canonical-map} (Canonical Map $\boxtimes_{C}$)
  \noindent Let $C$ be a tensor category, and $M_{C}, _{C}N$ be module categories. Define the functor
  \[
    M \times N \xrightarrow{\boxtimes_{C}} sk(M,C,N)
  \]
  to send the object $(m,n)$ to the object $\II{m}{n}{m}{n}{1_{m}}{1_{n}}{1_{1}}$, and the morphism
  \[
    (m,n) \xrightarrow{(\phi, \psi)} (m', n')
  \]
  to the morphism $\II{m'}{n'}{m}{n}{\phi}{\psi}{1_{1}}$.
\end{definition}

\noindent To quickly convince the reader that the skein category $sk(M,C,N)$
is indeed $M \boxtimes_{C} N$; we consider $N$ to be the trivial left
$C$-module category $_{C}C$, and argue that
$M \xrightarrow{\boxtimes_{C}} sk(M,C,C)$ is an isomorphism if $C$ is a
finite, pivotal tensor category and if $M$ is semisimple. It is
straightforward to see that it is indeed fully faithful, so it suffices to
show that it is essentially surjective. A typical object in the codomain
$sk(M,C,C)$ is some idempotent skein $\II{}{}{m}{c}{\phi}{\psi}{\overline{c}}$
(without loss of generality, assume $m$ to be simple). We contend that this
object is isomorphic to $\II{}{}{m \lhd c}{1}{\mu_{\phi, \psi}}{1}{1}$, where
\[
  \mu_{\phi,\psi} := m \lhd c \xrightarrow{\phi \lhd c} (m \lhd \overline{c}) \lhd c \xrightarrow[\sim]{\alpha} \xrightarrow{m \lhd \psi} m \lhd c.
\]
Indeed, the isomorphism is provided by the following two morphisms
$\II{mc}{1}{m}{c}{n}{u}{c^{\star}}$ and $\II{m}{c}{mc}{1}{1}{1}{c}$, where $n$ denotes the counit and $u$ denotes the unit for $c$. %TODO Check carefully and provide full proof here (may want to comment out).

\noindent We prove another lemma that will be useful later.

\begin{lemma}\label{lemma/I-provides-subobject}

  \noindent Let $C$ be a tensor category, and $M_{C}, _{C}N$ be module
  categories. Then any typical object $\II{}{}{m}{n}{\phi}{\psi}{c}$ (recall
  that it is an idempotent skein) in $sk(M,C,N)$ is a subobject of the
  canonical object $\boxtimes_{C}((m,n)) = \II{}{}{m}{n}{1_{m}}{1_{n}}{1}$.
\end{lemma}
\begin{proof}
  Indeed, both the inclusion arrow $\iota$ and the surjection arrow $\pi$ are
  given by the skein $\II{}{}{m}{n}{1_{m}}{1_{n}}{1}.$
\end{proof}

\section{Proof of Equivalence}\label{section/proof-of-equivalence}

\begin{theorem} \label{theorem/main-theorem}

  \noindent Let $C$ be a finite, semisimple, pivotal tensor category. Let
  $M_{C}, \, {}_{C}N$ be finite, semisimple $C$-module categories. Then the
  canonical map (\ref{definition/canonical-map}) $\boxtimes_{C}$:
  $M \times N \to sk(M,C,N)$ satisfies the universal property in the
  definition of $M \boxtimes_{C} N$. In particular, we have an equivalence of
  category
  \[
    sk(M,C,N) \simeq M \boxtimes_{C} N.
  \]
\end{theorem}

\begin{proof}
  Let $L$ be a linear category. We only need to show that $\boxtimes_{C}$
  induces an equivalence of categories
  \[
    Fun(sk(M,C,N), L) \xrightarrow[\sim]{\Theta} Fun^{C-bal}(M \times N, L).
  \]
  We construct $\Theta$ is in (\ref{lemma/construction-of-theta}), prove that
  it is faithfulness in (\ref{lemma/theta-is-faithful}), is full in (\ref{lemma/theta-is-full}), and is essentially
  surjective in (\ref{lemma/theta-is-essentially-surjective}).
\end{proof}

\begin{lemma}\label{lemma/construction-of-theta} (Construction of $\Theta$)

  \noindent Given the assumptions in the main theorem (\ref{theorem/main-theorem}), there exists a linear functor
  \[
    Theta: Fun(sk(M,C,N), L) \to Fun^{C-bal}(M \times N, L).
  \]
\end{lemma}

\begin{proof}
  \noindent (Object) Let $G$ be an object of the domain. Define $\Theta(G)$ to
  be $F := G \circ \boxtimes_{C} \in Fun(M \times N, L)$. We shall provide the
  balanced structure $\alpha$ for $F$, so that $(F, \alpha)$ is $C$-balanced.
  We need to provide the data
  \[
    \alpha_{m,c,n}: F(m \lhd c, n) = G(\II{}{}{mc}{n}{1}{1}{1}) \xrightarrow{\sim} G(\II{}{}{m}{cn}{1}{1}{1}) = F(m, c \rhd n),
  \]
  which is clearly satisfied by $G(\II{m}{cn}{mc}{n}{1}{1}{c}).$ So defined $\alpha$ is clearly natural.

  \noindent (Morphism) Let $G \xrightarrow{\eta} G'$ be a morphism in
  $Fun(sk(M,C,N), L)$. Its image under $\Theta$ is simply the horizontal
  composition $\eta \star (1_{\boxtimes_{C}})$. The remaining commutativity to
  be checked (cf p11 of Jin's note 20240906-110000) is a direct consequence of
  $\eta$'s naturality.
\end{proof}

\begin{lemma}\label{lemma/theta-is-faithful} ($\Theta$ is faithful) The linear
  functor $\Theta$ (\ref{lemma/construction-of-theta}) is faithful.
\end{lemma}

\begin{proof}
  (We use the same notation found in this section.) This amounts to showing
  that the following map is an injective linear map:
  \[
    (G \xrightarrow{\eta} G') \mapsto (F \xrightarrow{\Theta(\eta) = \eta \star (1_{\boxtimes_{C}})} F').
  \]
  It is clearly linear. For injectivity, we notice that whenever we have
  linear functors
  \[
    X \xrightarrow{f} Y,\quad Y \xrightarrow{g, g'} Z,
  \]
  and a linear natural transformation $\eta: g \to g'$, then the map $(\eta \mapsto \eta \star 1_{f})$ is injective is equivalent to
  \[
    (\forall x \in Obj(X), \eta_{f(x)} = 0) \Rightarrow (\forall y \in Obj(Y), \eta_{y} = 0).
  \]
  This holds if $f$ is surjective on objects. However, in our case
  $f = \boxtimes_{C}$ is not as strong. Fortunately, clearly it also holds if
  $f$ is almost-surjective, in the sense that each $y \in Obj(Y)$ has an
  $x \in Obj(X)$ such that $y$ is a subobject of $f(X)$. Indeed,
  \[
    1_{g(y)} = g(1_{y}) = g(\pi_{y} \circ \iota_{y}),
  \]
  so
  \[
    (g(y) \xrightarrow{\eta_{y}} g'(y)) = \eta_{y} \circ 1_{g(y)} = \eta_{y} \circ g(\pi \circ \iota) = g(\pi) \circ \eta_{f(x)} \circ g(\iota) = g(\pi) \circ 0 \circ g(\iota) = 0.
  \]
  This applies to our case by putting $f = \boxtimes_{C}$ and $g = G$, because
  each object $\II{}{}{m}{n}{\phi}{\psi}{c}$ is clearly a subobject of
  $\boxtimes_{C}(m,n) = \II{}{}{m}{n}{1}{1}{1}$. Therefore, $\Theta$ is faithful.
\end{proof}

\begin{lemma}\label{lemma/theta-is-full} ($\Theta$ is full)
  The linear functor $\Theta$ (\ref{lemma/construction-of-theta}) is full.
\end{lemma}

\begin{lemma}\label{lemma/theta-is-essentially-surjective} ($\Theta$ is essentially surjective)
  The linear functor $\Theta$ (\ref{lemma/construction-of-theta}) is essentially surjective.
\end{lemma}
